<html>
	<head>
	</head>
	<style type="text/css">
		body {
			background-color: slategray;
		}
	</style>
	<body>
		<h1>Hello world</h1>
		<object id="corgi-art" data="./CorgiArt.svg" type="image/svg+xml" />
		<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.1/TweenMax.min.js"></script>
		<script type="text/javascript">
			/*	TODOS
				- make unscrollable
				- mobile 
					- layout optimize
					- remove darken on focus

			*/

			// onComplete will flip this flag, so start at true.
			let toasterhasPopped = true;

			const svg = document.getElementById('corgi-art');

			svg.addEventListener('load', animate);
			
			function animate () {

				// Must run in localhost, doesn't load contentDocument if running HMTL locally.
				const corgi = svg.contentDocument;

				const rightpaw = corgi.getElementById("rightpaw");
				const leftpaw = corgi.getElementById("leftpaw");
				const mouse = corgi.getElementById("mouse");

				// Corgi hits keyboard, and code pops out toaster.
				const keyboardTl = new TimelineMax();
				const toasterTl = new TimelineMax({
					autoRemoveChildren: true,
					onComplete: () => toasterhasPopped = !toasterhasPopped,
				});

				// Have corgi use computer while idle.
				const mouseTl = new TimelineMax({
					repeat: -1,
					repeatDelay: 1
				});

				keyboardTl
				.to(leftpaw, .2, {rotation: 5, x: "-=1", y: "-=5"})
				.to(leftpaw, .1, {rotation: -7, x: "-=1", y: "+=4"})
				.to(leftpaw, .1, {rotation: 4, x: "+=1", y: "-=2"})
				.to(leftpaw, .2, {rotation: -2, x: "+=1", y: "+=3"})
				.pause()

				mouseTl
				.to(rightpaw, .4, {x: "-=3", y: "+=2"}, "+=5")
				.to(mouse, .4, {x: "-=3", y: "+=2"}, "-=.4")
				.to(rightpaw, .4, {x: "+=7", y: "-=5"}, "+=4")
				.to(mouse, .4, {x: "+=7", y: "-=5"}, "-=.4")
				.to(rightpaw, .6, {x: "-=3", y: "+=1"}, "+=4")
				.to(mouse, .6, {x: "-=3", y: "+=1"}, "-=.6")
				.to(rightpaw, .5, {x: "-=2", y: "+=3"}, "+=0.5")
				.to(mouse, .5, {x: "-=2", y: "+=3"}, "-=.5")
				.to(rightpaw, .7, {x: "+=1", y: "-=1"}, "+=5")
				.to(mouse, .7, {x: "+=1", y: "-=1"}, "-=.7")

				corgi.addEventListener('click', () => popToaster(corgi, keyboardTl, toasterTl));
			}

			function popToaster (corgi, keyboardTl, toasterTl) {
				const codea = corgi.getElementById("codea");
				const codeb = corgi.getElementById("codeb");
				const toasterSwitch = corgi.getElementById("switch");

				if (!keyboardTl.isActive() && !toasterTl.isActive()) {

					keyboardTl.restart();

					if (!toasterhasPopped) {
						toasterTl
						.to(codea, .8, {y: "-=16", ease: Elastic.easeOut}, "+=.4")
						.to(codeb, .8, {y: "-=16", ease: Elastic.easeOut}, "-=.8")
						.to(toasterSwitch, .4, {y: "-=18", ease: Elastic.easeOut.config(1, .8)}, "-=.8")
					} else {
						toasterTl
						.to(codea, .6, {y: "+=16"}, "+=.4")
						.to(codeb, .6, {y: "+=16"}, "-=.6")
						.to(toasterSwitch, .6, {y: "+=18"}, "-=.6")
					}
				}
			}
		</script>
	</body>
</html>